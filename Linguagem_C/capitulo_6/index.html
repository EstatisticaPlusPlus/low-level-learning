
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../capitulo_5/">
      
      
        <link rel="next" href="../gloss%C3%A1rio/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>6. Compilando com Otimização - Estatística++</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#6-compilando-com-otimizacao" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Estatística++" class="md-header__button md-logo" aria-label="Estatística++" data-md-component="logo">
      
  <img src="../../assets/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Estatística++
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Compilando com Otimização
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Estatística++" class="md-nav__button md-logo" aria-label="Estatística++" data-md-component="logo">
      
  <img src="../../assets/favicon.png" alt="logo">

    </a>
    Estatística++
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fortran
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Fortran
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Fortran/Fortran_77/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fortran 77
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Fortran/Fortran_90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fortran 90
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Julia
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Julia
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Julia/capitulo_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introdução
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linguagem C
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Linguagem C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capitulo_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introdução
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capitulo_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Compilando Programas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capitulo_3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Flags do Compilador
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capitulo_4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Depuração
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capitulo_5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Componentes do Compilador
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    6. Compilando com Otimização
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    6. Compilando com Otimização
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#61-otimizacao-em-nivel-de-codigo-fonte" class="md-nav__link">
    <span class="md-ellipsis">
      6.1. Otimização em Nível de Código-fonte
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1. Otimização em Nível de Código-fonte">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-eliminacao-de-subexpressoes-comuns" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.1. Eliminação de Subexpressões Comuns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#612-inclusao-de-funcao" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.2. Inclusão de Função
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#613-trade-offs-de-velocidade-e-espaco" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.3. Trade-offs de Velocidade e Espaço
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#614-desenrolamento-de-loops" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.4. Desenrolamento de Loops
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#615-agendamento" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.5. Agendamento
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-niveis-de-otimizacao-no-gcc" class="md-nav__link">
    <span class="md-ellipsis">
      6.2. Níveis de Otimização no GCC
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-otimizacao-e-depuracao" class="md-nav__link">
    <span class="md-ellipsis">
      6.3. Otimização e Depuração
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-otimizacao-e-avisos-do-compilador" class="md-nav__link">
    <span class="md-ellipsis">
      6.4. Otimização e Avisos do Compilador
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4. Otimização e Avisos do Compilador">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exemplo" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gloss%C3%A1rio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossário
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#61-otimizacao-em-nivel-de-codigo-fonte" class="md-nav__link">
    <span class="md-ellipsis">
      6.1. Otimização em Nível de Código-fonte
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1. Otimização em Nível de Código-fonte">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-eliminacao-de-subexpressoes-comuns" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.1. Eliminação de Subexpressões Comuns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#612-inclusao-de-funcao" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.2. Inclusão de Função
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#613-trade-offs-de-velocidade-e-espaco" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.3. Trade-offs de Velocidade e Espaço
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#614-desenrolamento-de-loops" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.4. Desenrolamento de Loops
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#615-agendamento" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.5. Agendamento
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-niveis-de-otimizacao-no-gcc" class="md-nav__link">
    <span class="md-ellipsis">
      6.2. Níveis de Otimização no GCC
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-otimizacao-e-depuracao" class="md-nav__link">
    <span class="md-ellipsis">
      6.3. Otimização e Depuração
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-otimizacao-e-avisos-do-compilador" class="md-nav__link">
    <span class="md-ellipsis">
      6.4. Otimização e Avisos do Compilador
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4. Otimização e Avisos do Compilador">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exemplo" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplo
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="6-compilando-com-otimizacao">6. Compilando com Otimização</h1>
<p>O GCC é um compilador otimizador que pode gerar arquivos executáveis mais rápidos e/ou menores, levando em consideração as características do processador alvo e a ordem das instruções. A otimização é um processo complexo que envolve a escolha da melhor combinação de instruções de máquina para cada comando de alto nível no código-fonte. Diferentes códigos devem ser gerados para processadores distintos, devido ao uso de linguagens de montagem e máquina incompatíveis. Além disso, cada tipo de processador possui características próprias, como o número de registradores disponíveis, que afetam a forma como o código é gerado. Ao compilar com otimização, o GCC leva em consideração todos esses fatores.</p>
<h2 id="61-otimizacao-em-nivel-de-codigo-fonte">6.1. Otimização em Nível de Código-fonte</h2>
<p>A otimização em nível de código-fonte melhora o desempenho de um programa por meio de alterações no código-fonte. Duas otimizações comuns são a eliminação de subexpressões repetidas e o <em>inline</em> de funções.</p>
<h3 id="611-eliminacao-de-subexpressoes-comuns">6.1.1. Eliminação de Subexpressões Comuns</h3>
<p>A eliminação de subexpressões repetidas evita a reavaliação de uma mesma expressão várias vezes. Por exemplo, a expressão</p>
<pre><code class="language-c">x = cos(v).(1+sin(u/2)) + sin(w).(1-sin(u/2))
</code></pre>
<p>pode ser reescrita como</p>
<pre><code class="language-c">t = sin(u/2); x = cos(v).(1+t) + sin(w).(1-t)
</code></pre>
<p>evitando a avaliação duplicada de <code>sin(u/2)</code>.</p>
<h3 id="612-inclusao-de-funcao">6.1.2. Inclusão de Função</h3>
<p>O <em>inline</em> de funções substitui uma chamada de função pelo seu próprio corpo, reduzindo a sobrecarga das chamadas de função. Por exemplo, a função <code>sq(x)</code> pode ser inlineada no <em>loop</em>:</p>
<pre><code class="language-c">for (i = 0; i &lt; 1000000; i++)
  sum += sq(i + 0.5);
</code></pre>
<p>Isso substitui o <em>loop</em> interno pelo corpo da função <code>sq(x)</code>, melhorando o desempenho ao evitar chamadas de função.</p>
<h3 id="613-trade-offs-de-velocidade-e-espaco">6.1.3. <em>Trade-offs</em> de Velocidade e Espaço</h3>
<p>Algumas formas de otimização podem aumentar a velocidade e reduzir o tamanho do programa simultaneamente, enquanto outras produzem código mais rápido em troca de um executável maior. Esse é o chamado <em>trade-off</em> de velocidade e espaço. Tais otimizações podem, inclusive, ser aplicadas de forma inversa, diminuindo o tamanho do executável em detrimento da velocidade de execução.</p>
<h3 id="614-desenrolamento-de-loops">6.1.4. Desenrolamento de <em>Loops</em></h3>
<p>O desenrolamento de <em>loops</em> é uma otimização que aumenta a velocidade dos <em>loops</em> eliminando a condição de "fim do <em>loop</em>" em cada iteração. Ele permite atribuições diretas, sem a necessidade de testes, resultando em uma execução mais rápida. Contudo, o desenrolamento pode aumentar o tamanho do executável, exceto em <em>loops</em> muito curtos.</p>
<h3 id="615-agendamento">6.1.5. Agendamento</h3>
<p>O agendamento é o nível mais baixo de otimização, onde o compilador determina a melhor ordem de execução das instruções individuais. Essa técnica melhora a velocidade do executável sem aumentar seu tamanho, mas exige memória adicional e tempo durante o processo de compilação.</p>
<h2 id="62-niveis-de-otimizacao-no-gcc">6.2. Níveis de Otimização no GCC</h2>
<p>O GCC oferece diferentes níveis de otimização (0 a 3) para controlar o tempo de compilação, o uso de memória do compilador e o <em>trade-off</em> entre velocidade e espaço no executável resultante. Os níveis de otimização são:</p>
<ul>
<li><code>-O0</code> (padrão): Sem otimização, compilando de forma direta para facilitar a depuração.</li>
<li><code>-O1</code>: Otimizações comuns sem <em>trade-offs</em> significativos de velocidade e espaço.</li>
<li><code>-O2</code>: Otimizações adicionais sem aumentar o tamanho do executável.</li>
<li><code>-O3</code>: Otimizações mais custosas que podem aumentar o tamanho do executável.</li>
<li><code>-funroll-loops</code>: Desenrolamento de <em>loops</em>, aumentando o tamanho do executável.</li>
<li><code>-Os</code>: Otimizações para reduzir o tamanho do executável.</li>
</ul>
<p>É importante considerar os custos das otimizações, como maior complexidade na depuração e maior tempo/memória de compilação. Geralmente, <code>-O0</code> é usado para depuração e <code>-O2</code> para desenvolvimento e implantação.</p>
<h2 id="63-otimizacao-e-depuracao">6.3. Otimização e Depuração</h2>
<p>Com o GCC, é possível usar otimização em combinação com a opção de depuração <code>-g</code>. Muitos compiladores não permitem essa combinação. Ao usar depuração e otimização juntas, as reorganizações internas feitas pelo otimizador podem dificultar a compreensão do que está acontecendo ao examinar um programa otimizado no depurador. Por exemplo, variáveis temporárias geralmente são eliminadas e a ordem das instruções pode ser alterada. No entanto, quando um programa trava inesperadamente, qualquer informação de depuração é melhor do que nenhuma, portanto, o uso de <code>-g</code> é recomendado tanto para desenvolvimento quanto para implantação. Nas versões dos pacotes GNU, a opção de depuração <code>-g</code> é habilitada por padrão juntamente com a opção de otimização <code>-O2</code>.</p>
<h2 id="64-otimizacao-e-avisos-do-compilador">6.4. Otimização e Avisos do Compilador</h2>
<p>Quando a otimização é ativada, o GCC pode produzir avisos adicionais que não aparecem ao compilar sem otimização. Durante a otimização, o compilador realiza uma análise de fluxo de dados, examinando o uso de todas as variáveis e seus valores iniciais. Essa análise é a base para outras estratégias de otimização, como o agendamento de instruções, e pode detectar o uso de variáveis não inicializadas.</p>
<p>A opção <code>-Wuninitialized</code> (incluída em <code>-Wall</code>) avisa sobre variáveis que são lidas sem serem inicializadas. Ela só funciona quando o programa é compilado com otimização, pois é necessário que a análise de fluxo de dados esteja ativa. Considere o seguinte exemplo:</p>
<h4 id="exemplo">Exemplo</h4>
<pre><code class="language-c">int sign(int x)
{
  int s;
  if (x &gt; 0)
    s = 1;
  else if (x &lt; 0)
    s = -1;
  return s;
}
</code></pre>
<p>A função funciona corretamente para a maioria dos argumentos, mas tem um bug quando <code>x</code> é zero – nesse caso, o valor de retorno da variável <code>s</code> será indefinido. Compilar o programa apenas com a opção <code>-Wall</code> não produz nenhum aviso, porque a análise de fluxo de dados não é realizada sem otimização:</p>
<pre><code class="language-bash">$ gcc -Wall -c uninit.c
</code></pre>
<p>Para gerar um aviso, o programa deve ser compilado com <code>-Wall</code> e otimização simultaneamente. Na prática, o nível de otimização <code>-O2</code> é recomendado para obter bons avisos:</p>
<pre><code class="language-bash">$ gcc -Wall -O2 -c uninit.c
</code></pre>
<p>Isso detecta corretamente a possibilidade de a variável <code>s</code> ser usada sem ser definida. Embora o GCC geralmente encontre a maioria das variáveis não inicializadas, ele utiliza heurísticas que podem, ocasionalmente, deixar passar casos complicados ou emitir falsos avisos. Nesses casos, pode ser útil reescrever as partes relevantes do código para melhorar a legibilidade e eliminar o aviso.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>